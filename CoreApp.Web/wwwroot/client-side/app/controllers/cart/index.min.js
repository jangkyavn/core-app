"use strict";var CartController=function(){var n={colors:[],sizes:[]};this.initialize=function(){r(function(){u(function(){t()})});i()};var i=function(){$("body").on("click",".btn-delete",function(n){n.preventDefault();var i=$(this).data("id");core.callAjax("/Cart/RemoveFromCart","POST",{productId:i},"json",function(){core.notify(message.delete_to_item_cart_success,"success");BaseController.loadHeaderCart();t()})});$("body").on("keyup",".txtQuantity",function(n){n.preventDefault();var r=$(this).data("id"),i=$(this).val();i>0?core.callAjax("/Cart/UpdateCart","POST",{productId:r,quantity:i},"json",function(){core.notify(message.update_to_cart_success,"success");BaseController.loadHeaderCart();t()}):core.notify("Không hợp lệ","error")});$("body").on("change",".ddlColorId",function(n){n.preventDefault();var r=parseInt($(this).closest("tr").data("id")),u=$(this).val(),i=$(this).closest("tr").find(".txtQuantity").first().val(),f=$(this).closest("tr").find(".ddlSizeId").first().val();i>0?core.callAjax("/Cart/UpdateCart","POST",{productId:r,quantity:i,color:u,size:f},"json",function(){core.notify(message.update_to_cart_success,"success");BaseController.loadHeaderCart();t()}):core.notify("Your quantity is invalid","error")});$("body").on("change",".ddlSizeId",function(n){n.preventDefault();var r=parseInt($(this).closest("tr").data("id")),u=$(this).val(),i=parseInt($(this).closest("tr").find(".txtQuantity").first().val()),f=parseInt($(this).closest("tr").find(".ddlColorId").first().val());i>0?core.callAjax("/Cart/UpdateCart","POST",{productId:r,quantity:i,color:f,size:u},"json",function(){core.notify(message.update_to_cart_success,"success");BaseController.loadHeaderCart();t()}):core.notify("Your quantity is invalid","error")});$("#btnClearAll").on("click",function(n){n.preventDefault();var i=confirm("Bạn có chắc chắn muốn xóa tất cả sản phẩm trong giỏ hàng không?");i&&core.callAjax("/Cart/ClearCart","POST",null,"json",function(){core.notify("Xóa tất cả sản phẩm trong giỏ hàng thành công!","success");BaseController.loadHeaderCart();t()})})},r=function(t){core.callAjax("/Cart/GetColors","GET",null,"json",function(i){n.colors=i;t()})},u=function(t){return core.callAjax("/Cart/GetSizes","GET",null,"json",function(i){n.sizes=i;t()})},f=function(t){var i="<select class='form-control' id='ddlColorId'><option value='0'><\/option>";return $.each(n.colors,function(n,r){i+=t===r.Id?'<option value="'+r.Id+'" selected="select">'+r.Name+"<\/option>":'<option value="'+r.Id+'">'+r.Name+"<\/option>"}),i+="<\/select>"},e=function(t){var i="<select class='form-control' id='ddlSizeId'> <option value='0'><\/option>";return $.each(n.sizes,function(n,r){i+=t===r.Id?'<option value="'+r.Id+'" selected="select">'+r.Name+"<\/option>":'<option value="'+r.Id+'">'+r.Name+"<\/option>"}),i+="<\/select>"},t=function(){return core.callAjax("/Cart/GetCart","GET",null,"json",function(t){var u=$("#cartItemTemplate").html(),i="",r=0;$.each(t,function(t,o){console.log(n.colors);console.log(n.sizes);i+=Mustache.render(u,{ProductId:o.Product.Id,ProductName:o.Product.Name,UrlImage:`/uploaded/images/products/${o.Product.Image}`,Price:core.formatNumber(o.Price,0),Quantity:o.Quantity,Colors:f(o.Color===null?0:o.Color.Id),Sizes:e(o.Size===null?"":o.Size.Id),Amount:core.formatNumber(o.Price*o.Quantity,0),Url:"/"+o.Product.SeoAlias+"-p."+o.Product.Id+".html"});r+=o.Price*o.Quantity});$("#lblTotalAmount").text(core.formatNumber(r,0));i!==""?($("#lblEmptyCart").hide(),$(".table-responsive").show(),$("#cartsContent").html(i),$(".checkout-btn").show(),$("#btnClearAll").show()):($("#lblEmptyCart").show(),$(".table-responsive").hide(),$(".checkout-btn").hide(),$("#btnClearAll").hide())})}};