"use strict";var BaseController={initialize:function(){BaseController.loadHeaderCart();BaseController.initialControls();BaseController.registerEvents()},registerEvents:function(){$("body").on("click",".remove-cart",function(n){n.preventDefault();var t=parseInt($(this).data("id"));core.callAjax("/Cart/RemoveFromCart","POST",{productId:t},"json",function(){core.notify(resources.delete_to_item_cart_success,"success");BaseController.loadHeaderCart()})});$("body").on("click",".btn-country",function(n){n.preventDefault();var t=$(this).data("value");$("#hidCulture").val(t);$("#selectLanguage").submit()})},initialControls:function(){$("#txtKeywordSearch").autocomplete({minLength:0,source:function(n,t){$.ajax({url:"/Product/SuggestSearchResult",type:"get",dataType:"json",data:{keyword:n.term},success:function(n){t(n)}})},select:function(n,t){return $("#txtKeywordSearch").val(t.item.Name),!1},open:function(){$(".ui-autocomplete").css("width","550px");$(".ui-autocomplete").css("max-height","500px");$(".ui-autocomplete").css("overflow-y","auto")}}).autocomplete("instance")._renderItem=function(n,t){return $("<li>").append(`
                    <div style='display:flex; flex-direction:row; flex:10'>
                        <div style='flex:2'>
                            <img src='/uploaded/images/products/${t.Image}' width='100' />
                        </div>
                        <div style='flex:8; display:flex; flex-direction:column; font-size: 20px;'>
                            <a href='/${t.SeoAlias}-p.${t.Id}.html'>${t.Name}</a>
                            <div>${core.formatNumber(t.Price,0)}</div>
                        </div>
                    </div>
                `).appendTo(n)}},loadHeaderCart:function(){core.callAjax("/Cart/GetCart","GET",null,"json",function(n){var i=$("#templateHeaderCart").html(),t='<ul id="cart-sidebar" class="mini-products-list">';if(n.length){$.each(n,function(r,u){var e=`/${u.Product.SeoAlias}-p.${u.Product.Id}.html`,o=`/uploaded/images/products/${u.Product.Image}`,f=r+1;t+=Mustache.render(i,{IsLast:f===n.length?"last":"",EvenOdd:f%2==0?"even":"odd",ProductId:u.Product.Id,ProductName:u.Product.Name,Image:o,Price:core.formatNumber(u.Price,0),Quantity:u.Quantity,Url:e})});let r=n.reduce((n,t)=>n+t.Price*t.Quantity,0);t+=`</ul><div class="top-subtotal">Tổng tiền: <span class="price">${core.formatNumber(r,0)} VNĐ</span></div>
                            <div class="actions">
                                <button class="btn-checkout" type="button" onClick="location.href='/dat-hang.html'"><i class="fa fa-check"></i><span>Đặt hàng</span></button>
                                <button class="view-cart" type="button" onClick="location.href='/gio-hang.html'"><i class="fa fa-shopping-cart"></i><span>Xem giỏ</span></button>
                            </div>`}else t=`<div style="text-align: center; padding: 1rem 0;">
                                    Không có sản phẩm nào trong giỏ hàng
                                </div>`;$("#cartContent").html(t);$("#cartTotal").text(n.length)})},loadQuickViewData:function(n){core.callAjax("/Product/GetQuickViewData","GET",{id:n},"json",function(n){var t=n.Data,f="",e,i,r,u;for(t.HotFlag===!0&&t.HotFlag!==null&&(f+='<div class="icon-sale-label sale-left">Hot<\/div>'),core.getDiffDay(t.DateCreated)<=7&&(f+='<div class="icon-new-label new-right">Mới<\/div>'),$("#lblQuickViewLabel").html(f),$(".cloud-zoom").attr("href",`/uploaded/images/products/${t.Image}`),$("#imgQuickViewImage").attr("src",`/uploaded/images/products/${t.Image}?w=321&h=321`),$("#lblQuickViewName").text(t.Name),t.PromotionPrice!==null&&t.PromotionPrice!==""?$("#lblQuickViewPrice").html(`
                    <p class="special-price">
                        <span class="price"> ${core.formatNumber(t.PromotionPrice,0)} </span>
                    </p>
                    <p class="old-price">
                        <span class="price"> ${core.formatNumber(t.Price,0)} </span>
                    </p>
                `):$("#lblQuickViewPrice").html(`
                    <span class="regular-price">
                        <span class="price">${core.formatNumber(t.Price,0)}</span>
                    </span>
                `),e="",i=1;i<=5;i++)e+=i<=n.Rating?'<i class="fa fa-star"><\/i>':'<i class="fa fa-star-o"><\/i>';$("#lblQuickViewRating").html(e);$("#lblQuickViewStatus").text(t.Status===1?"Còn hàng":"Hết hàng");$("#lblQuickViewDescription").text(t.Description);r='<select class="form-control" id="ddlQuickViewColors">';$.each(n.Colors,function(n,t){r+=`<option value='${t.Id}'>${t.Name}</option>`});r+="<\/select>";$("#lblQuickViewColors").html(r);u='<select class="form-control" id="ddlQuickViewSizes">';$.each(n.Sizes,function(n,t){u+=`<option value='${t.Id}'>${t.Name}</option>`});u+="<\/select>";$("#lblQuickViewSizes").html(u)})}};BaseController.initialize();